# basic, single config file for all the containers
version: "3"
services:
  web:
    container_name: thoughts-app
    image: thoughts-app
    #  restart whenever it fails
    # restart: always
    # look in the current directory for a docker file to build the image
    build: .
    restart: always
    # mapping of local machine port to the container
    ports:
      - "4000:3000"
    external_links:
      - thoughts-data
  mongo1:
    image: mongo:6
    restart: always
    container_name: mongodb1
    volumes:
      - mongodata1:/data/db
    expose:
      - "27017"
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]

  mongo2:
    image: mongo:6
    restart: always
    container_name: mongo2
    volumes:
      - mongodata2:/data/db
    expose:
      - "27017"
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]

  mongo3:
    image: mongo:6
    restart: always
    container_name: mongo3
    volumes:
      - mongodata3:/data/db
    expose:
      - "27017"
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]
