# basic, single config file for all the containers
services:
  web:
    container_name: thoughtsapp
    image: thoughtsbackend
    volumes:
      - ./src/:/app/src
    #  restart whenever it fails
    # restart: always
    # look in the current directory for a docker file to build the image
    # build: .
    restart: always
    # mapping of local machine port to the container
    ports:
      - 8000:8000
    # - "4000:3000"
    # external_links:
    #   - thoughts-data

  mongo1:
    image: mongo:6
    container_name: mongo1
    restart: always
    volumes:
      - ./scripts/rs-init.sh:/scripts/rs-init.sh
      - ./scripts/init.js:/scripts/init.js
    #   - mongodata1:/data/db
    # expose:
    #   - "27017"
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]
    depends_on:
      - mongo2
      - mongo3

  mongo2:
    image: mongo:6
    container_name: mongo2
    restart: always
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]
    # volumes:
    #   - mongodata2:/data/db
    # expose:
    #   - "27017"

  mongo3:
    image: mongo:6
    container_name: mongo3
    restart: always
    entrypoint:
      ["/usr/bin/mongod", "--replSet", "thoughts_mongo_set", "--bind_ip_all"]
    # volumes:
    #   - mongodata3:/data/db
    # expose:
    #   - "27017"
# volumes:
#   mongodata1:
#   mongodata2:
#   mongodata3:

# to
